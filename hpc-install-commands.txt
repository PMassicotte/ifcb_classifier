## Installation steps for Poseidon, WHOI's HPC ##
# These instruction will create a directory in your username's hpc scratch space.
# It assumes that you have already logged into poseidon with a terminal with "ssh <username>@poseidon.whoi.edu"
# Note: This is only for running neuston_net and neuston_run on the WHOI HPC.

cd /vortexfs1/scratch/<username>
git clone https://github.com/WHOIGit/ifcb_classifier.git ifcb
git clone https://github.com/joefutrelle/pyifcb.git ifcb/pyifcb
cd ifcb
mkdir training-data training-output run-data run-output slurm-logs
conda create -n ifcb python=3.7
# If you get “conda: command not found”, the anaconda hpc module may not be loaded. Do “module load anaconda” and try again.
# Make sure you also have cuda modules loaded: “module load cuda91/toolkit cuda91/blas cuda91/cudnn cuda91/fft”
conda activate ifcb
conda install pytorch=1.1 torchvision cudatoolkit=9.0 -c pytorch
# There are more recent versions of pytorch and cuda, but these are the ones that the hpc has cuda-version modules for.
conda install scikit-learn matplotlib h5py scipy pandas requests scikit-image Pillow=6.1
pip install rectpack pysmb
(cd pyifcb; python setup.py install)
# DONE! Your installation is ready to go. You can test that things were correctly installed by doing:
python neuston_net.py --help
python neuston_run.py --help
